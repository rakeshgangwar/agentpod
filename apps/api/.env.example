# =============================================================================
# AgentPod Management API Configuration
# =============================================================================
# Copy this file to .env and fill in the values
#
# For local development, most defaults work out of the box.
# For production, you MUST change all security-related values.
# =============================================================================

# =============================================================================
# Server Configuration
# =============================================================================
PORT=3001
NODE_ENV=development

# =============================================================================
# Authentication (Better Auth)
# =============================================================================
# Session secret for cookie signing
# Generate with: openssl rand -base64 32
SESSION_SECRET=your-session-secret-change-in-production

# GitHub OAuth (optional but recommended for production)
# Create an OAuth app at: https://github.com/settings/developers
# Callback URL: http://localhost:3001/api/auth/callback/github (dev)
#              https://your-domain.com/api/auth/callback/github (prod)
GITHUB_CLIENT_ID=
GITHUB_CLIENT_SECRET=

# =============================================================================
# API Security
# =============================================================================
# API token for authenticating requests from mobile app
# Generate with: openssl rand -base64 32
API_TOKEN=your-api-token-change-in-production

# 32-byte encryption key for encrypting provider credentials (API keys, tokens)
# Generate with: openssl rand -base64 32
ENCRYPTION_KEY=your-32-byte-encryption-key-here!

# =============================================================================
# Docker Orchestration (New Architecture)
# =============================================================================
# Docker socket path (default works for most setups)
DOCKER_SOCKET=/var/run/docker.sock

# Docker network for sandbox containers
DOCKER_NETWORK=agentpod-net

# Container name prefix (sandboxes are named: {prefix}-{slug})
DOCKER_CONTAINER_PREFIX=agentpod

# =============================================================================
# Traefik Configuration
# =============================================================================
# Enable Traefik label generation for automatic routing
TRAEFIK_ENABLED=true

# Network Traefik is connected to
TRAEFIK_NETWORK=agentpod-net

# Enable TLS (set to true for production with proper certificates)
TRAEFIK_TLS=false

# Certificate resolver name (e.g., 'letsencrypt' - configure in Traefik)
TRAEFIK_CERT_RESOLVER=

# =============================================================================
# Domain Configuration
# =============================================================================
# Base domain for sandbox URLs
# Development: localhost
# Production: your-domain.com
BASE_DOMAIN=localhost

# Protocol (http for localhost, https for production)
DOMAIN_PROTOCOL=http

# =============================================================================
# Data Storage
# =============================================================================
# Base directory for all persistent data
DATA_DIR=./data

# Git repositories storage (where cloned repos are stored)
REPOS_DIR=./data/repos

# Container volumes storage
VOLUMES_DIR=./data/volumes

# SQLite database path
DATABASE_PATH=./data/database.sqlite

# =============================================================================
# API URLs
# =============================================================================
# Public URL of Management API (containers call this to fetch user config)
# Development: http://api.localhost (via Traefik)
# Production: https://api.your-domain.com
MANAGEMENT_API_PUBLIC_URL=http://api.localhost

# Default user ID (until proper auth is fully implemented)
DEFAULT_USER_ID=default-user

# =============================================================================
# OpenCode Configuration
# =============================================================================
# OpenCode server port inside containers
OPENCODE_SERVER_PORT=4096

# =============================================================================
# Container Registry (Production)
# =============================================================================
# For local development, leave these empty to use locally built images.
# For production, configure your container registry.

# Registry URL (without https://)
# Example: forgejo.your-domain.com, ghcr.io, docker.io
OPENCODE_REGISTRY_URL=

# Registry owner/namespace
# Example: your-username, your-org
OPENCODE_REGISTRY_OWNER=

# Container version to deploy
OPENCODE_CONTAINER_VERSION=latest

# =============================================================================
# LEGACY CONFIGURATION (Deprecated)
# =============================================================================
# These settings are kept for migration purposes only.
# The new architecture does not require Coolify, Forgejo, or Keycloak.

# Coolify (deprecated - use direct Docker API)
COOLIFY_URL=
COOLIFY_TOKEN=
COOLIFY_PROJECT_UUID=
COOLIFY_SERVER_UUID=

# Forgejo (deprecated - use filesystem-based Git)
FORGEJO_URL=
FORGEJO_PUBLIC_URL=
FORGEJO_TOKEN=
FORGEJO_OWNER=

# Keycloak (deprecated - use Better Auth)
KEYCLOAK_REALM_URL=
KEYCLOAK_API_CLIENT_ID=
KEYCLOAK_API_CLIENT_SECRET=
KEYCLOAK_CONTAINER_CLIENT_ID=
KEYCLOAK_CONTAINER_CLIENT_SECRET=
KEYCLOAK_COOKIE_SECRET=
